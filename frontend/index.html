<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Meal Plan Generator</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; }
        label { display: block; margin-top: 10px; }
        input, select { width: 300px; padding: 5px; margin-top: 5px; }
        button { margin-top: 20px; padding: 10px 20px; }
        #output { margin-top: 20px; white-space: pre-wrap; background: #f2f2f2; padding: 10px; }
    </style>
</head>
<body>
    <h1>Diabetes Meal Plan Generator</h1>
    <form id="userForm">
        <label>Name: <input type="text" id="name" required></label>
        <label>Age: <input type="number" id="age" required></label>
        <label>Gender: 
            <select id="gender" required>
                <option value="M">Male</option>
                <option value="F">Female</option>
            </select>
        </label>
        <label>Height (cm): <input type="number" id="height_cm" required></label>
        <label>Weight (kg): <input type="number" id="weight_kg" required></label>
        <label>Activity Level: 
            <select id="activity_level" required>
                <option value="sedentary">Sedentary</option>
                <option value="light">Light</option>
                <option value="moderate">Moderate</option>
                <option value="active">Active</option>
            </select>
        </label>
        <label>Goal:
            <select id="goal" required>
                <option value="weight_loss">Weight Loss</option>
                <option value="weight_gain">Weight Gain</option>
                <option value="maintenance">Maintenance</option>
            </select>
        </label>
        <label>Diabetes Patient: 
            <select id="diabetes" required>
                <option value="true">Yes</option>
                <option value="false">No</option>
            </select>
        </label>
        <label>Upload Report (if diabetic): <input type="file" id="report_file"></label>
        <button type="submit">Generate Meal Plan</button>
    </form>

    <div id="output"></div>

    <script>
        const form = document.getElementById('userForm');
        const output = document.getElementById('output');

        form.addEventListener('submit', async (e) => {
            e.preventDefault();

            const formData = new FormData();
            formData.append("name", document.getElementById("name").value);
            formData.append("age", document.getElementById("age").value);
            formData.append("gender", document.getElementById("gender").value);
            formData.append("height_cm", document.getElementById("height_cm").value);
            formData.append("weight_kg", document.getElementById("weight_kg").value);
            formData.append("activity_level", document.getElementById("activity_level").value);
            formData.append("goal", document.getElementById("goal").value);
            formData.append("diabetes", document.getElementById("diabetes").value);

            const reportFile = document.getElementById("report_file").files[0];
            if (reportFile) {
                formData.append("report_file", reportFile);
            }

            try {
                const response = await fetch("http://127.0.0.1:8000/recommend", {
                    method: "POST",
                    body: formData
                });

                if (!response.ok) {
                    throw new Error(`Error: ${response.status}`);
                }

                const data = await response.json();
                output.textContent = JSON.stringify(data, null, 2);
            } catch (err) {
                output.textContent = err;
            }
        });
    </script>
</body>
</html>
